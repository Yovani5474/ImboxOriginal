# ğŸ“Š Vista Excel - Ãrea de Corte

## âœ… NUEVA FUNCIONALIDAD AGREGADA

Se ha agregado una vista tipo Excel para gestionar las transferencias del Ãrea de Corte.

---

## ğŸ“ ARCHIVO CREADO

```
c:\xampp\htdocs\1\transferencias_excel.php
```

---

## ğŸ¯ CARACTERÃSTICAS

### **Vista de Tabla Excel:**
- âœ… DiseÃ±o similar a Microsoft Excel
- âœ… Todas las transferencias en una sola vista
- âœ… BÃºsqueda en tiempo real
- âœ… ExportaciÃ³n directa a Excel (.xlsx)
- âœ… EstadÃ­sticas en tiempo real
- âœ… Acciones rÃ¡pidas (Ver/Editar)

### **Funcionalidades:**

1. **BÃºsqueda InstantÃ¡nea**
   - Filtra por referencia, proveedor, orden de compra
   - Resultados en tiempo real mientras escribes

2. **Exportar a Excel**
   - Descarga el archivo .xlsx con un solo clic
   - Nombre automÃ¡tico: transferencias_corte_YYYY-MM-DD.xlsx
   - Compatible con Microsoft Excel, LibreOffice, Google Sheets

3. **EstadÃ­sticas Visuales**
   - Total de transferencias
   - Transferencias pendientes
   - Total de rollos
   - Total de metros

4. **Acciones RÃ¡pidas**
   - Ver detalle completo
   - Editar transferencia
   - Todo con un solo clic

---

## ğŸš€ CÃ“MO ACCEDER

### **OpciÃ³n 1: Desde el Panel Principal**

```
http://localhost/1/
```

En el menÃº de navegaciÃ³n superior encontrarÃ¡s:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Control de Entrada | Transferencias    â”‚
â”‚ Ver Transferencias | Vista Excel â­    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### **OpciÃ³n 2: Desde Acciones RÃ¡pidas**

En el dashboard principal, secciÃ³n "Acciones RÃ¡pidas":
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Nuevo Control                      â”‚
â”‚ Nueva Transferencia                â”‚
â”‚ Ver Transferencias                 â”‚
â”‚ Vista Excel â­ NUEVO               â”‚
â”‚ Reportes                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### **OpciÃ³n 3: URL Directa**

```
http://localhost/1/transferencias_excel.php
```

---

## ğŸ“Š VISTA PREVIA

### **Pantalla Principal:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“Š Transferencias - Vista Excel                        â”‚
â”‚  Ãrea de Corte | EnvÃ­o de prendas a Empaque            â”‚
â”‚                                      [ Panel Control ]  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   50     â”‚ â”‚    12    â”‚ â”‚  1,250   â”‚ â”‚  5,678   â”‚  â”‚
â”‚  â”‚  Total   â”‚ â”‚Pendientesâ”‚ â”‚  Rollos  â”‚ â”‚  Metros  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [ğŸ” Buscar...]              [ğŸ“Š Exportar a Excel]     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ID â”‚Referencia â”‚Fecha â”‚Proveedorâ”‚OC   â”‚Rollosâ”‚Estado â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚  50 â”‚COR-2025..â”‚05/11 â”‚Proveedorâ”‚P-123â”‚  25  â”‚Enviadoâ”‚
â”‚  49 â”‚COR-2025..â”‚04/11 â”‚Proveedorâ”‚P-122â”‚  30  â”‚Comple.â”‚
â”‚  48 â”‚COR-2025..â”‚03/11 â”‚Proveedorâ”‚P-121â”‚  20  â”‚Pendi. â”‚
â”‚  ...                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ’¡ FUNCIONES JAVASCRIPT

### **BÃºsqueda en Tiempo Real:**

```javascript
document.getElementById('searchInput').addEventListener('keyup', function() {
    const searchText = this.value.toLowerCase();
    // Filtra las filas de la tabla
});
```

### **Exportar a Excel:**

```javascript
function exportToExcel() {
    const table = document.getElementById('transferenciasTable');
    const wb = XLSX.utils.table_to_book(table);
    XLSX.writeFile(wb, 'transferencias_corte.xlsx');
}
```

### **Acciones:**

```javascript
function verDetalle(id) {
    window.location.href = 'control_entrada.php?id=' + id;
}

function editarTransferencia(id) {
    window.location.href = 'control_entrada.php?id=' + id + '&editar=1';
}
```

---

## ğŸ¨ DISEÃ‘O

### **Colores:**
- **Primario:** #FF8C00 (Naranja IMBOX)
- **Secundario:** #FFA500 (Naranja claro)
- **Fondo:** #f5f5f5 (Gris claro)
- **Cards:** #FFFFFF (Blanco)

### **Estados:**
- **Pendiente:** Amarillo (#ffc107)
- **Enviado:** Naranja (#FF8C00)
- **Completado:** Verde (#28a745)

---

## ğŸ“¦ DEPENDENCIAS

### **Incluidas en CDN:**

```html
<!-- Bootstrap 5.1.3 -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css">

<!-- Font Awesome 6.0 -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

<!-- SheetJS (XLSX) -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
```

---

## ğŸ—„ï¸ CONSULTAS SQL

### **Obtener Transferencias:**

```sql
SELECT * FROM controles_entrada 
ORDER BY fecha_creacion DESC 
LIMIT 100
```

### **EstadÃ­sticas:**

```sql
-- Total por estado
SELECT estado, COUNT(*) as total 
FROM controles_entrada 
GROUP BY estado

-- Totales de materiales
SELECT 
    SUM(total_rollos) as total_rollos,
    SUM(total_metros) as total_metros 
FROM controles_entrada
```

---

## ğŸ”§ PERSONALIZACIÃ“N

### **Cambiar LÃ­mite de Registros:**

En `transferencias_excel.php`, lÃ­nea ~22:

```php
// Cambiar de 100 a tu valor deseado
$stmt = $db->query("
    SELECT * FROM controles_entrada 
    ORDER BY fecha_creacion DESC 
    LIMIT 100  <-- Cambiar aquÃ­
");
```

### **Agregar Columnas:**

1. Modificar la consulta SQL
2. Agregar `<th>` en el thead
3. Agregar `<td>` en el tbody

---

## âœ¨ VENTAJAS

```
âœ… VisualizaciÃ³n rÃ¡pida de todas las transferencias
âœ… BÃºsqueda instantÃ¡nea sin recargar pÃ¡gina
âœ… ExportaciÃ³n a Excel con un clic
âœ… EstadÃ­sticas en tiempo real
âœ… DiseÃ±o profesional y moderno
âœ… Responsive (funciona en mÃ³viles)
âœ… No requiere instalaciÃ³n
âœ… Compatible con SQLite
```

---

## ğŸš€ PRÃ“XIMAS MEJORAS

Posibles funcionalidades futuras:

- [ ] Filtros avanzados (por fecha, estado, proveedor)
- [ ] Ordenamiento por columnas
- [ ] PaginaciÃ³n
- [ ] ImpresiÃ³n directa
- [ ] Exportar a PDF
- [ ] GrÃ¡ficos estadÃ­sticos
- [ ] Modo oscuro

---

## ğŸ“ SOPORTE

Para problemas o sugerencias, documenta:

1. URL donde ocurre el error
2. Mensaje de error (si existe)
3. Navegador utilizado
4. Captura de pantalla

---

**Sistema IMBOX v6.1**  
**Ãrea de Corte - Vista Excel**  
**Fecha: 02/11/2025**  
**Estado: âœ… FUNCIONAL**
